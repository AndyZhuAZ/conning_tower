import 'dart:convert';

import 'package:conning_tower/models/data/kcsapi/kcsapi.dart';
import 'package:flutter_test/flutter_test.dart';

main() {
  test(ReqSortieBattleEntity.source, () {

    var json = jsonDecode('''{"api_result":1,"api_result_msg":"成功","api_data":{"api_deck_id":3,"api_formation":[1,3,1],"api_f_nowhps":[37,22,22,41,25,26,39],"api_f_maxhps":[37,22,22,41,25,26,39],"api_fParam":[[39,0,36,34],[12,88,0,21],[12,84,0,19],[64,70,128,61],[16,72,0,22],[12,68,0,23],[65,84,91,53]],"api_ship_ke":[2209,1615,1765,1592,1623,1623],"api_ship_lv":[1,1,1,1,1,1],"api_e_nowhps":[760,96,88,66,46,46],"api_e_maxhps":[760,96,88,66,46,46],"api_eSlot":[[1644,1644,1645,1646,-1],[1556,1557,1558,1558,-1],[1574,1547,1548,1549,-1],[1550,1550,1545,1525,-1],[1502,1559,1544,-1,-1],[1502,1559,1544,-1,-1]],"api_eParam":[[195,185,180,275],[25,0,50,80],[35,0,48,73],[64,92,96,68],[58,76,48,36],[58,76,48,36]],"api_flavor_info":[{"api_boss_ship_id":"2209","api_type":"2","api_voice_id":"582220710","api_class_name":"大型新駆逐艦","api_ship_name":"米駆逐棲姫-壊","api_message":"少しハ…少シハマなンだッテイウの……？<br>ァ……ソォーオ？　ジャア遠リョハいラナイね？<br>全力デ潰スわァっ！","api_pos_x":"280","api_pos_y":"-51","api_data":""}],"api_smoke_type":0,"api_balloon_cell":0,"api_atoll_cell":1,"api_midnight_flag":1,"api_search":[1,1],"api_air_base_attack":[{"api_base_id":1,"api_stage_flag":[1,1,1],"api_plane_from":[null,[2,3,4]],"api_squadron_plane":[{"api_mst_id":138,"api_count":2},{"api_mst_id":225,"api_count":18},{"api_mst_id":504,"api_count":18},{"api_mst_id":504,"api_count":18}],"api_stage1":{"api_f_count":56,"api_f_lostcount":9,"api_e_count":187,"api_e_lostcount":29,"api_disp_seiku":3,"api_touch_plane":[-1,-1]},"api_stage2":{"api_f_count":30,"api_f_lostcount":14,"api_e_count":0,"api_e_lostcount":0},"api_stage3":{"api_erai_flag":[0,1,1,0,0,0],"api_ebak_flag":[0,0,0,0,0,0],"api_ecl_flag":[0,0,0,0,0,0],"api_edam":[0,45,0,0,0,0],"api_e_sp_list":[null,null,null,null,null,null]}},{"api_base_id":1,"api_stage_flag":[1,1,1],"api_plane_from":[null,[2,3,4]],"api_squadron_plane":[{"api_mst_id":138,"api_count":2},{"api_mst_id":225,"api_count":18},{"api_mst_id":504,"api_count":18},{"api_mst_id":504,"api_count":18}],"api_stage1":{"api_f_count":56,"api_f_lostcount":12,"api_e_count":158,"api_e_lostcount":50,"api_disp_seiku":0,"api_touch_plane":[138,1574]},"api_stage2":{"api_f_count":27,"api_f_lostcount":0,"api_e_count":0,"api_e_lostcount":0},"api_stage3":{"api_erai_flag":[0,1,0,0,0,1],"api_ebak_flag":[0,0,0,0,0,0],"api_ecl_flag":[0,0,0,0,0,0],"api_edam":[0,84,0,0,0,114],"api_e_sp_list":[null,null,null,null,null,null]}}],"api_stage_flag":[1,1,1],"api_kouku":{"api_plane_from":[[1,5],[3]],"api_stage1":{"api_f_count":6,"api_f_lostcount":0,"api_e_count":50,"api_e_lostcount":18,"api_disp_seiku":0,"api_touch_plane":[-1,-1]},"api_stage2":{"api_f_count":0,"api_f_lostcount":0,"api_e_count":24,"api_e_lostcount":20,"api_air_fire":{"api_idx":3,"api_kind":5,"api_use_items":[363,363,279]}},"api_stage3":{"api_frai_flag":[0,0,0,0,0,0,1],"api_erai_flag":[0,0,0,0,0,0],"api_fbak_flag":[0,0,0,0,0,0,null],"api_ebak_flag":[0,0,0,0,0,0],"api_fcl_flag":[0,0,0,0,0,0,0],"api_ecl_flag":[0,0,0,0,0,0],"api_fdam":[0,0,0,0,0,0,0],"api_edam":[0,0,0,0,0,0],"api_f_sp_list":[null,null,null,null,null,null,null],"api_e_sp_list":[null,null,null,null,null,null]}},"api_support_flag":2,"api_support_info":{"api_support_airatack":null,"api_support_hourai":{"api_deck_id":4,"api_ship_id":[5500,3240,312,3058,3052,769],"api_undressing_flag":[0,0,0,0,0,0],"api_cl_list":[0,0,2,0,1,0,0],"api_damage":[0,0,187,0,54.1,0,0]}},"api_opening_taisen_flag":1,"api_opening_taisen":{"api_at_eflag":[1],"api_at_list":[0],"api_at_type":[0],"api_df_list":[[5]],"api_si_list":[[1644]],"api_cl_list":[[1]],"api_damage":[[20]]},"api_opening_flag":1,"api_opening_atack":{"api_frai_list_items":[null,null,null,null,[0,3],null,null],"api_fcl_list_items":[null,null,null,null,[1,1],null,null],"api_fdam":[28,0,0,0,0,0,0],"api_fydam_list_items":[null,null,null,null,[82,178],null,null],"api_erai_list_items":[[0],null,null,null,null,null,null],"api_ecl_list_items":[[1],null,null,null,null,null,null],"api_edam":[82,0,0,178.1,0,0,0],"api_eydam_list_items":[[28],null,null,null,null,null,null]},"api_hourai_flag":[1,0,0,1],"api_hougeki1":{"api_at_eflag":[0,1,0,0],"api_at_list":[0,0,6,3],"api_at_type":[0,0,0,0],"api_df_list":[[0],[2],[0],[0]],"api_si_list":[[-1],[1644],[366],[363]],"api_cl_list":[[1],[1],[2],[1]],"api_damage":[[69],[16],[80],[63]]},"api_hougeki2":null,"api_hougeki3":null,"api_raigeki":{"api_frai":[-1,0,-1,0,0,-1,0],"api_fcl":[0,1,0,1,1,0,1],"api_fdam":[0,0,0,28,0,0,0],"api_fydam":[0,30,0,41,31,0,35],"api_erai":[3,-1,-1,-1,-1,-1,-1],"api_ecl":[1,0,0,0,0,0,0],"api_edam":[137,0,0,0,0,0,0],"api_eydam":[28,0,0,0,0,0,0]}}}''');

    var data = ReqSortieBattleEntity.fromJson(json);

    expect(data.apiData.apiKouku.apiStage3?.apiFbakFlag?.last, null);
    expect(data.apiData.apiOpeningAtack?.apiFraiListItems[4], [0, 3]);
  });
}