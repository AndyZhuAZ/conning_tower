import 'dart:convert';

import 'package:conning_tower/models/data/kcsapi/kcsapi.dart';
import 'package:conning_tower/models/feature/dashboard/kancolle/data.dart';
import 'package:flutter_test/flutter_test.dart';

main() {
  test(GetMemberMapinfoEntity.source, () {
    // /api_get_member/mapinfo
    var json = jsonDecode('''
    {"api_result":1,"api_result_msg":"成功","api_data":{"api_map_info":[{"api_id":11,"api_cleared":1},{"api_id":12,"api_cleared":1},{"api_id":13,"api_cleared":1},{"api_id":14,"api_cleared":1},{"api_id":15,"api_cleared":1,"api_gauge_type":1,"api_gauge_num":1},{"api_id":16,"api_cleared":0,"api_defeat_count":0,"api_required_defeat_count":7,"api_gauge_type":1,"api_gauge_num":1},{"api_id":21,"api_cleared":1},{"api_id":22,"api_cleared":1},{"api_id":23,"api_cleared":1},{"api_id":24,"api_cleared":1},{"api_id":25,"api_cleared":0,"api_defeat_count":0,"api_required_defeat_count":4,"api_gauge_type":1,"api_gauge_num":1},{"api_id":31,"api_cleared":1},{"api_id":32,"api_cleared":1},{"api_id":33,"api_cleared":1},{"api_id":34,"api_cleared":1},{"api_id":35,"api_cleared":0,"api_defeat_count":0,"api_required_defeat_count":4,"api_gauge_type":1,"api_gauge_num":1},{"api_id":41,"api_cleared":1},{"api_id":42,"api_cleared":1},{"api_id":43,"api_cleared":1},{"api_id":44,"api_cleared":1,"api_gauge_type":1,"api_gauge_num":1},{"api_id":45,"api_cleared":0,"api_defeat_count":0,"api_required_defeat_count":5,"api_gauge_type":1,"api_gauge_num":1},{"api_id":51,"api_cleared":1},{"api_id":52,"api_cleared":1,"api_gauge_type":1,"api_gauge_num":1},{"api_id":53,"api_cleared":1,"api_gauge_type":1,"api_gauge_num":1},{"api_id":54,"api_cleared":1,"api_gauge_type":1,"api_gauge_num":1},{"api_id":55,"api_cleared":0,"api_defeat_count":1,"api_required_defeat_count":5,"api_gauge_type":1,"api_gauge_num":1},{"api_id":61,"api_cleared":1},{"api_id":62,"api_cleared":1,"api_gauge_type":1,"api_gauge_num":1},{"api_id":63,"api_cleared":1,"api_gauge_type":1,"api_gauge_num":1},{"api_id":64,"api_cleared":1,"api_gauge_type":1,"api_gauge_num":1,"api_air_base_decks":1},{"api_id":65,"api_cleared":0,"api_defeat_count":0,"api_required_defeat_count":6,"api_gauge_type":1,"api_gauge_num":1,"api_air_base_decks":2},{"api_id":71,"api_cleared":1,"api_gauge_type":1,"api_gauge_num":1},{"api_id":72,"api_cleared":1,"api_defeat_count":0,"api_required_defeat_count":3,"api_gauge_type":1,"api_gauge_num":1},{"api_id":73,"api_cleared":1,"api_defeat_count":0,"api_required_defeat_count":3,"api_gauge_type":1,"api_gauge_num":1},{"api_id":74,"api_cleared":1,"api_defeat_count":1,"api_required_defeat_count":5,"api_gauge_type":1,"api_gauge_num":1,"api_air_base_decks":1},{"api_id":75,"api_cleared":0,"api_defeat_count":0,"api_required_defeat_count":2,"api_gauge_type":1,"api_gauge_num":1},{"api_id":591,"api_cleared":1,"api_s_no":3,"api_eventmap":{"api_state":2,"api_selected_rank":4},"api_sally_flag":[1,0,0],"api_gauge_type":2,"api_gauge_num":1,"api_air_base_decks":1},{"api_id":592,"api_cleared":0,"api_s_no":2,"api_eventmap":{"api_now_maphp":8500,"api_max_maphp":8500,"api_state":1,"api_selected_rank":4},"api_sally_flag":[1,7,0],"api_gauge_type":2,"api_gauge_num":2,"api_air_base_decks":2}],"api_air_base":[{"api_area_id":6,"api_rid":1,"api_name":"第一基地航空隊","api_distance":{"api_base":0,"api_bonus":0},"api_action_kind":0,"api_plane_info":[{"api_squadron_id":1,"api_state":0,"api_slotid":0},{"api_squadron_id":2,"api_state":0,"api_slotid":0},{"api_squadron_id":3,"api_state":0,"api_slotid":0},{"api_squadron_id":4,"api_state":0,"api_slotid":0}]},{"api_area_id":6,"api_rid":2,"api_name":"第二基地航空隊","api_distance":{"api_base":0,"api_bonus":0},"api_action_kind":0,"api_plane_info":[{"api_squadron_id":1,"api_state":0,"api_slotid":0},{"api_squadron_id":2,"api_state":0,"api_slotid":0},{"api_squadron_id":3,"api_state":0,"api_slotid":0},{"api_squadron_id":4,"api_state":0,"api_slotid":0}]},{"api_area_id":6,"api_rid":3,"api_name":"第三基地航空隊","api_distance":{"api_base":0,"api_bonus":0},"api_action_kind":0,"api_plane_info":[{"api_squadron_id":1,"api_state":0,"api_slotid":0},{"api_squadron_id":2,"api_state":0,"api_slotid":0},{"api_squadron_id":3,"api_state":0,"api_slotid":0},{"api_squadron_id":4,"api_state":0,"api_slotid":0}]},{"api_area_id":7,"api_rid":1,"api_name":"第一基地航空隊","api_distance":{"api_base":6,"api_bonus":0},"api_action_kind":1,"api_plane_info":[{"api_squadron_id":1,"api_state":1,"api_slotid":6173,"api_count":17,"api_max_count":18,"api_cond":1},{"api_squadron_id":2,"api_state":1,"api_slotid":44776,"api_count":16,"api_max_count":18,"api_cond":1},{"api_squadron_id":3,"api_state":1,"api_slotid":6073,"api_count":16,"api_max_count":18,"api_cond":1},{"api_squadron_id":4,"api_state":1,"api_slotid":13918,"api_count":17,"api_max_count":18,"api_cond":1}]},{"api_area_id":7,"api_rid":2,"api_name":"第二基地航空隊","api_distance":{"api_base":0,"api_bonus":0},"api_action_kind":0,"api_plane_info":[{"api_squadron_id":1,"api_state":0,"api_slotid":0},{"api_squadron_id":2,"api_state":0,"api_slotid":0},{"api_squadron_id":3,"api_state":0,"api_slotid":0},{"api_squadron_id":4,"api_state":0,"api_slotid":0}]},{"api_area_id":59,"api_rid":1,"api_name":"第一基地航空隊","api_distance":{"api_base":5,"api_bonus":0},"api_action_kind":1,"api_plane_info":[{"api_squadron_id":1,"api_state":1,"api_slotid":30291,"api_count":11,"api_max_count":18,"api_cond":1},{"api_squadron_id":2,"api_state":1,"api_slotid":29937,"api_count":5,"api_max_count":18,"api_cond":1},{"api_squadron_id":3,"api_state":1,"api_slotid":35550,"api_count":10,"api_max_count":18,"api_cond":1},{"api_squadron_id":4,"api_state":1,"api_slotid":41905,"api_count":14,"api_max_count":18,"api_cond":1}]},{"api_area_id":59,"api_rid":2,"api_name":"第二基地航空隊","api_distance":{"api_base":8,"api_bonus":0},"api_action_kind":1,"api_plane_info":[{"api_squadron_id":1,"api_state":1,"api_slotid":44064,"api_count":18,"api_max_count":18,"api_cond":1},{"api_squadron_id":2,"api_state":1,"api_slotid":9240,"api_count":18,"api_max_count":18,"api_cond":1},{"api_squadron_id":3,"api_state":1,"api_slotid":14741,"api_count":18,"api_max_count":18,"api_cond":1},{"api_squadron_id":4,"api_state":1,"api_slotid":7798,"api_count":18,"api_max_count":18,"api_cond":1}]}],"api_air_base_expanded_info":[{"api_area_id":59,"api_maintenance_level":3}]}}
    ''');

    final data = GetMemberMapinfoEntity.fromJson(json);

    expect(data, isNotNull);

    final mapState = KancolleData.parseMapState(data);

    for (final state in mapState.values) {
      expect(state.type, isNotNull);
      expect(state.cleared, isNotNull);
      print(jsonEncode(state));
    }
  });
}